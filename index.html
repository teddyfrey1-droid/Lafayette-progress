<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#2563eb">
  <meta name="mobile-web-app-capable" content="yes">

  <title>Heiko - Dashboard Lafayette</title>
  
  <!-- CSS Files -->
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/animations.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/admin.css">
  <link rel="stylesheet" href="css/calendar.css">
  <link rel="stylesheet" href="css/enhancements.css">
  <link rel="stylesheet" href="css/money-tank.css">
  
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

  <!-- Firebase setup overlay (shown if config missing) -->
  <div id="firebaseSetupOverlay" class="modal-overlay" style="display:none;">
    <div class="modal-box" style="max-width:560px;">
      <div class="modal-title">âš™ï¸ Configuration Firebase</div>
      <p id="firebaseSetupHint" style="font-size:13px; color:var(--text-muted); margin-bottom:10px;"></p>
      <textarea id="firebaseConfigTextarea" class="fb-input" style="min-height:150px;" placeholder='Colle ici le JSON firebaseConfig (ex: {"apiKey":"...", ...})'></textarea>
      <div id="firebaseSetupError" style="color:#ef4444; font-size:13px; margin-top:8px;"></div>
      <div style="display:flex; gap:10px; margin-top:12px;">
        <button class="btn" onclick="saveFirebaseConfigFromUi()">Sauvegarder & Recharger</button>
        <button class="btn" style="background:var(--border-color); color:var(--text-muted);" onclick="document.getElementById('firebaseSetupOverlay').style.display='none'">Fermer</button>
      </div>
      <div style="margin-top:10px; font-size:12px; color:var(--text-muted);">
        Astuce : si tu veux la rÃ©initialiser â†’ console : <code>localStorage.removeItem('heiko_firebase_config')</code>
      </div>
    </div>
  </div>

  <!-- Theme Toggle -->
  <div class="theme-toggle" onclick="toggleDarkMode()">
    <div class="theme-toggle-slider"><span class="toggle-icon">â˜€ï¸</span></div>
  </div>

  <!-- Top Alert -->
  <div id="topAlert">
      <div class="alert-icon">ğŸ“£</div>
      <div class="alert-content">
          <div class="alert-title">NOUVEAUTÃ‰ !</div>
          <div class="alert-desc" id="topAlertText">...</div>
      </div>
  </div>

  <!-- Feedback Button -->
  <div class="feedback-btn" onclick="document.getElementById('feedbackModal').style.display='flex'" title="Proposer une idÃ©e">
    <span class="feedback-btn-icon">ğŸ’¡</span>
    <span class="feedback-btn-text">Une idÃ©e ?</span>
  </div>

  <!-- Feedback Modal -->
  <div id="feedbackModal" class="modal-overlay">
      <div class="modal-box">
          <div class="modal-title">ğŸ’¡ BoÃ®te Ã  idÃ©es</div>
          <p style="font-size:13px; color:var(--text-muted); margin-bottom:15px;">Une suggestion pour amÃ©liorer l'outil ou l'Ã©quipe ? Dites-le nous !</p>
          <textarea id="fbContent" class="fb-input" placeholder="Votre message..."></textarea>
          <div style="display:flex; gap:10px;">
              <button class="btn" onclick="sendFeedback()">Envoyer</button>
              <button class="btn" style="background:var(--border-color); color:var(--text-muted);" onclick="document.getElementById('feedbackModal').style.display='none'">Fermer</button>
          </div>
      </div>
  </div>

  <!-- Updates Modal -->
  <div id="updatesModal" class="modal-overlay">
      <div class="modal-box">
          <div class="modal-title">
             <span>ğŸ“¢ DerniÃ¨res NouveautÃ©s</span>
             <button style="border:none; background:none; font-size:20px; cursor:pointer; color:var(--text-main);" onclick="document.getElementById('updatesModal').style.display='none'">Ã—</button>
          </div>
          <div id="publicUpdatesList" style="display:flex; flex-direction:column; gap:10px;">
              <div style="text-align:center; color:#999;">Chargement...</div>
          </div>
      </div>
  </div>

  <!-- Toast -->
  <div id="toast">âœ… Action effectuÃ©e avec succÃ¨s !</div>

  <!-- Login Overlay -->
  <div id="loginOverlay">
    <div class="login-box">
      <div class="login-title">ğŸš€ DASHBOARD LAFAYETTE ğŸš€</div>
      
      <div id="loginBox">
        <input type="email" id="loginEmail" placeholder="Email" />
        <div class="input-group">
          <input type="password" id="loginPassword" placeholder="Mot de passe" />
        </div>
        <button class="btn" onclick="login()">Se connecter</button>
      </div>
    </div>
  </div>

  <!-- App Content -->
  <div id="appContent" style="display: none;">
    <div class="container">
      
      <!-- Top Bar -->
      <div class="top-bar">
        <div class="user-welcome">Bonjour <strong>Utilisateur</strong></div>
        <div class="topbar-actions">
          <button class="btn" style="width: auto; padding: 10px 20px;" onclick="openUpdatesModal()">ğŸ“¢ NouveautÃ©s</button>
          <div class="menu-wrapper">
            <button class="icon-btn" id="menuBtn" aria-label="Menu" aria-haspopup="true" aria-expanded="false">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M4 7H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M4 12H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M4 17H20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </button>
            <div class="menu-dropdown" id="menuDropdown" role="menu" aria-label="Menu">
              <a href="index.html" role="menuitem">Dashboard</a>
              <a href="contacts.html" role="menuitem">Contacts</a>
              <a href="sites-utiles.html" role="menuitem">Sites utiles</a>
              <a href="#" id="menuAdmin" role="menuitem" style="display:none;" onclick="openAdminPanel(); return false;">Admin</a>
              <a href="#" id="menuLogout" role="menuitem" style="display:none;">Se dÃ©connecter</a>
              <a href="#" role="menuitem" onclick="document.getElementById('firebaseSetupOverlay').style.display='flex'; return false;">Configurer Firebase</a>
            </div>
          </div>
        </div>
      </div>

      <!-- Header -->
      <header>
        <div class="header-pill">ğŸ¯ Suivi des Objectifs</div>
        <h1>Dashboard Lafayette</h1>
        <div class="last-update">DerniÃ¨re mise Ã  jour : ...</div>
      </header>

      <!-- Global Score -->
      <div class="global-score-container">
        <div class="global-score-value">0%</div>
        <div class="global-score-label">Score Global</div>
      </div>

      <!-- Motivation strip (optional, UI-only) -->
      <div id="motivationStrip" class="motivation-strip">
        <div class="motivation-left">
          <div id="motivationTitle" class="motivation-title">Objectif du jour</div>
          <div id="motivationMain" class="motivation-main">...</div>
          <div id="motivationSub" class="motivation-sub">...</div>
        </div>
      </div>

      <!-- Primary Objectives -->
      <div class="objectives-wrapper">
        <h2 class="category-title">ğŸ¯ Objectifs Principaux</h2>
        <div id="primaryObjectives">
          <!-- Les cartes objectifs seront gÃ©nÃ©rÃ©es ici -->
        </div>

        <h2 class="category-title secondary">ğŸ“Š Objectifs Secondaires</h2>
        <div id="secondaryObjectives">
          <!-- Les cartes objectifs secondaires seront gÃ©nÃ©rÃ©es ici -->
        </div>
      </div>

      <!-- Calendar -->
      <div class="native-cal-container">
        <div class="cal-header">
          <button class="cal-nav-btn" onclick="navigateCalendar('prev')">â—€</button>
          <div class="cal-month-title">DÃ©cembre 2025</div>
          <button class="cal-nav-btn" onclick="navigateCalendar('next')">â–¶</button>
        </div>
        <div id="calendarGrid" class="cal-grid"></div>
        <div class="cal-legend">
          <div class="legend-item"><span class="legend-dot evt-heiko"></span> Heiko</div>
          <div class="legend-item"><span class="legend-dot evt-sturia"></span> Sturia</div>
          <div class="legend-item"><span class="legend-dot evt-deliv"></span> Livraisons</div>
        </div>
      </div>

    </div>
  </div>

  <!-- Admin Panel (simplifiÃ©) -->
  <div id="adminPanel" class="admin-panel">
    <button class="close-admin" onclick="closeAdminPanel()">Ã—</button>
    <h2 style="margin-bottom: 20px; font-size: 24px; font-weight: 900;">âš™ï¸ ADMIN</h2>
    
    <div class="admin-section">
      <h3 style="margin-bottom: 15px;">ğŸ‘¥ Utilisateurs</h3>
      <div id="usersList"></div>
    </div>

    <div class="admin-section">
      <h3 style="margin-bottom: 15px;">ğŸ¯ Objectifs</h3>
      <div id="objectivesList"></div>
    </div>
  </div>

  <!-- JavaScript Files - IMPORTANT: Dans cet ordre -->
  <script src="js/config.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/data.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/dashboard.js"></script>
  <script src="js/admin.js"></script>
  <script src="js/calendar.js"></script>
  <script src="js/simulator.js"></script>
  <script src="js/motivation.js"></script>
  <script src="js/money_tank.js"></script>
  <script src="js/nav.js"></script>
  <script src="js/motivation.js"></script>
  <script src="js/money_tank.js"></script>

</body>
</html>
